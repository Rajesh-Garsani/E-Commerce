{# templates/product_detail.html #}
{% extends "base.html" %}
{% block content %}
<div class="product-detail-container">
  <div class="product-gallery">
    <div class="main-image">
      <img src="{{ product.image.url }}" alt="{{ product.name }}">
    </div>
  </div>

  <div class="product-info">
    <h1>{{ product.name }}</h1>

    <div class="product-meta">
      {% if product.old_price %}
        <span class="old-price">${{ product.old_price }}</span>
      {% endif %}
      <span class="current-price">${{ product.price }}</span>
    </div>

    <p class="product-description">{{ product.description }}</p>
    <div class="product-rating">‚≠ê {{ product.rating }}</div>

    <div class="product-actions">
      {# Use POST form for add_to_cart (safer than GET anchor). Fallback to JS is supported. #}
      <form method="post" action="{% url 'add_to_cart' product.id %}">
        {% csrf_token %}
        <input type="hidden" name="product_id" value="{{ product.id }}">
        <button type="submit" class="btn btn-cart" name="action" value="add_to_cart">
          <i class="fas fa-shopping-cart"></i> Add to Cart
        </button>
      </form>

      <form method="post" action="{% url 'product_detail' product.slug %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-buy" name="action" value="order_now">
          <i class="fas fa-check"></i> Order Now
        </button>
      </form>
    </div>

    <div class="product-category">
      Category:
      <a href="{% url 'category_products' product.category.slug %}">{{ product.category.name }}</a>
    </div>
  </div>
</div>
{% endblock %}
